services:
  easy-redact:
    build: .
    ports:
      - "3000:3000"
    environment:
      # Azure OpenAI (cloud)
      AZURE_OPENAI_API_KEY: ${AZURE_OPENAI_API_KEY}
      AZURE_OPENAI_API_BASE: ${AZURE_OPENAI_API_BASE}
      AZURE_OPENAI_API_VERSION: ${AZURE_OPENAI_API_VERSION:-2024-12-01-preview}
      AZURE_OPENAI_DEPLOYMENT: ${AZURE_OPENAI_DEPLOYMENT:-gpt-5.2}
      # Local LLM (Ollama-compatible)
      OPENAI_API_BASE: ${OPENAI_API_BASE:-http://host.docker.internal:11434/v1}
      OPENAI_API_KEY: ${OPENAI_API_KEY:-ollama}
      LOCAL_LLM_MODEL: ${LOCAL_LLM_MODEL:-llama3.3:latest}
      # Corporate proxy (optional)
      HTTPS_PROXY: ${HTTPS_PROXY:-}
      HTTP_PROXY: ${HTTP_PROXY:-}
      NO_PROXY: ${NO_PROXY:-}
      # Docker-only features
      LIBREOFFICE_PATH: /usr/bin/libreoffice
      SPACY_ENABLED: "true"
    extra_hosts:
      - "host.docker.internal:host-gateway"  # allows connecting to host Ollama
